dist: trusty
sudo: false
language: node_js
node_js:
- 8.4.0
branches:
  except:
  - "/\\+travis\\.\\d+$/"
env:
  global:
  - NPM_REGISTRY=https://atomist.jfrog.io/atomist/api/npm/npm-dev-local
  - secure: vtbtwlHKz8Itj7lUHEd3Dg3hmb4SeT9qInsp2AoGBcEdCu0Ud9Rn1q1zw6UREHOlHtF2Aben0akPkk80st1nRKDe0YQTmQq4/dPGAa6zCSSDjSRqN3j6kYTBHZjrBeMM+Dr0wc8EwtizfQCmGWudLpcZRaye1LILOfmK3inL8oPNT65FPbruGarzAZWZH1J8qlzgfcDuPxkMc9eedRnDrQ6ZDYg2pfKwlga3QUJQeQcljnXaDAOwYvpGdkzVeKbmgALO4lHDetToJTGMOERQ4kQwv9dS2L7JpPTnRN/I+DcPACr+F8XzUkA54NN5W5zbFMT8mGswZBK3pRbOAF2/9YTeJJy3DzznDq/tE0jGf9ANvgIwPNVuniXLhqro2DzJzKQmkxuFXLpqVohXcpniD6ejp6+Zu/nUlRGG9rr5WCloE8rJolSHJ3aO8sAT2HZcpoGOB6z2IPXtVVhXgHXFv4sY46XhD0IRDWjmLqgCQiGdkOBtIntYXJbivfkUVcSCYfEY+qfOjpDshCX1e8zsQScqlzEgwbx0dXx2c55KkHSflcEQIkNTmZlff1TAzPHbIRfCFeYXK4QPV0PyZmnS3tPMu2YvPyQA5k6qB8Nwru2NbTpv3oMlKeI7IK83xL7dkJ7cOM1AEkpxMpguVDaAzEeyIHX3ibc1ih+uESBqDts=
before_install:
- openssl aes-256-cbc -K $encrypted_39386a58a2e6_key -iv $encrypted_39386a58a2e6_iv
  -in scripts/.npmrc.enc -out $HOME/.npmrc -d
script: bash scripts/travis-build.bash
notifications:
  email: false
  webhooks:
    urls:
    - https://webhook.atomist.com/atomist/travis/teams/T29E48P34
    on_success: always
    on_failure: always
    on_start: always
    on_cancel: always
    on_error: always
cache:
  directories:
  - "$HOME/.npm"
after_deploy:
- bash scripts/gh-publish.bash $TRAVIS_REPO_SLUG
deploy:
  provider: releases
  api_key:
    secure: gA2R/ny1YaeLMSLsCq2jnTWXEmcYcNJdijr/z+q2z2PHBrAVJL3h4csCN30h0lsVCF7I8AEa2mF6SMyCZ5FrEuuyC1rLcmQqK5Gng8uGyY3kVlELgXOXX74pHjqGYxufuD6SOdu2C8vuVa/3udsJsWOkrPoWcTbVYab5JtZQFhP2+NdvVAzy0HRtmhOfgfx3OPQPYl664pSkSrn/llPbD8wnJQLcxY+qkrDfmQI7nh57oRC41TNOnwBwVtia/IRMUwMDUedL4pB525ISxXHTItiKVbZN4UV4z3HcSqd0Y2RlGzDzHFw+MGtwc4/xlpvvJKGuYdRmUXDb+9qyd84HhttA8V3LSUqkCAA1G9QGzgPH+jLqOnN0TL52y8Iah+TC1JVOye33SiFV96JcS7LzkVxvm6AnXDsBFZeXix4ZCXhnZpcWLaMwZ4vNt5dJ3/4FrOezfYyDckKQZekbKoWeklj8lgLllEaov+QS4P5EkM7WR0lgTWuk5qa2D0BabiNQ58oCZtuZ8Aj7bDu3i6HmtpYuJ+iBAGMWtPz10tDVWqBDMkUm+rGqVbIACvCz/oGcPtK/K8C0n942g+sRzd/dMBOqQFjSaBAw7M4k7Bxxu+ICPtA6pm0XxAOcWJR8L4Va+CgQby3GSgo3T7QR7MTiem55vduqtCXoAz2463APKsw=
  on:
    tags: true
    condition: "$TRAVIS_TAG =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-(m|rc)\\.[0-9]+)?$"
